"""Graph utilities and lightweight in-memory structures."""

from .ingest import Graph, compute_weight, ingest_document, ingest_extrinsic
from .inference import (
    PredictionRecord,
    PredictionSet,
    RawPrediction,
    TrainingArtifacts,
    TriplePack,
    build_prediction_set,
    get_case_identifiers,
    get_provision_identifiers,
    legal_graph_to_triples,
    load_predictions_json,
    load_predictions_sqlite,
    persist_predictions_json,
    persist_predictions_sqlite,
    rank_predictions,
    score_applies_predictions,
    train_distmult,
    train_complex,
    train_mure,
    train_rotate,
    train_transe,
)
from .models import (
    CaseNode,
    EdgeType,
    ExtrinsicNode,
    GraphEdge,
    GraphNode,
    IssueNode,
    JudgeOpinionNode,
    LegalGraph,
    NodeType,
    OrderNode,
    PrincipleNode,
    StatuteSectionNode,
    TestElementNode,
)
from .principle_graph import build_principle_graph
from .proof_tree import (
    ProofTree,
    ProofTreeEdge,
    ProofTreeNode,
    Provenance,
    ResultNode,
    ResultTable,
    expand_proof_tree,
)
from .tircorder import (
    TiRCorderBuilder,
    applies_to,
    articulates,
    build_tircorder_edges,
    controls,
    has_element,
    interprets,
)
from .rgcn import (
    RGCNConfig,
    RGCNEpochResult,
    RGCNGraphData,
    RGCNTrainer,
    RGCNTrainingResult,
    RGCNBackendNotAvailableError,
    attach_embeddings,
    export_embeddings,
    legal_graph_to_dgl,
    load_embeddings,
)

__all__ = [
    "Graph",
    "ingest_document",
    "EdgeType",
    "GraphEdge",
    "GraphNode",
    "LegalGraph",
    "NodeType",
    "ProofTree",
    "ProofTreeEdge",
    "ProofTreeNode",
    "Provenance",
    "ResultNode",
    "ResultTable",
    "expand_proof_tree",
    "ExtrinsicNode",
    "CaseNode",
    "JudgeOpinionNode",
    "PrincipleNode",
    "TestElementNode",
    "StatuteSectionNode",
    "IssueNode",
    "OrderNode",
    "ingest_extrinsic",
    "compute_weight",
    "TiRCorderBuilder",
    "build_tircorder_edges",
    "articulates",
    "has_element",
    "applies_to",
    "interprets",
    "controls",
    "build_principle_graph",
    "TriplePack",
    "TrainingArtifacts",
    "RawPrediction",
    "PredictionRecord",
    "PredictionSet",
    "legal_graph_to_triples",
    "get_case_identifiers",
    "get_provision_identifiers",
    "train_transe",
    "train_distmult",
    "train_complex",
    "train_rotate",
    "train_mure",
    "score_applies_predictions",
    "rank_predictions",
    "build_prediction_set",
    "persist_predictions_json",
    "persist_predictions_sqlite",
    "load_predictions_json",
    "load_predictions_sqlite",
    "RGCNConfig",
    "RGCNEpochResult",
    "RGCNGraphData",
    "RGCNTrainer",
    "RGCNTrainingResult",
    "RGCNBackendNotAvailableError",
    "attach_embeddings",
    "export_embeddings",
    "legal_graph_to_dgl",
    "load_embeddings",
]

